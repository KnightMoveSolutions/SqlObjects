

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Debugging &mdash; KnightMoves.SqlObjects 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Security" href="security.html" />
    <link rel="prev" title="Parameterized Queries" href="parameterized-queries.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #0255a3" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/knight_move_solutions_sqlobjects_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick-start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="select.html">SELECT FROM</a></li>
<li class="toctree-l1"><a class="reference internal" href="join.html">JOIN</a></li>
<li class="toctree-l1"><a class="reference internal" href="insert.html">INSERT</a></li>
<li class="toctree-l1"><a class="reference internal" href="update.html">UPDATE</a></li>
<li class="toctree-l1"><a class="reference internal" href="delete.html">DELETE</a></li>
<li class="toctree-l1"><a class="reference internal" href="where.html">WHERE</a></li>
<li class="toctree-l1"><a class="reference internal" href="case.html">CASE</a></li>
<li class="toctree-l1"><a class="reference internal" href="group-by.html">GROUP BY</a></li>
<li class="toctree-l1"><a class="reference internal" href="order-by.html">ORDER BY</a></li>
<li class="toctree-l1"><a class="reference internal" href="having.html">HAVING</a></li>
<li class="toctree-l1"><a class="reference internal" href="union.html">UNION</a></li>
<li class="toctree-l1"><a class="reference internal" href="calculations.html">Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="subqueries.html">Subqueries</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="comments.html">Comments</a></li>
<li class="toctree-l1"><a class="reference internal" href="serialization.html">Serialization</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameterized-queries.html">Parameterized Queries</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced-concepts.html">Advanced Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">KnightMoves.SqlObjects</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Debugging</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/debugging.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p><a class="reference external" href="https://docs.knightmovesolutions.com">Documentation Home</a></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>All examples used are valid against the <a class="reference external" href="https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/sql/linq/downloading-sample-databases">Microsoft Northwind Sample Database</a>
You can run the resulting SQL from the examples against Northwind in order to test and play with the SqlObjects library.</p>
</div>
<div class="section" id="debugging">
<h1>Debugging<a class="headerlink" href="#debugging" title="Permalink to this headline">¶</a></h1>
<p>One of the goals of this library is a pleasant debugging experience. This is accomplished in two ways.</p>
<ol class="arabic">
<li><p>Indented “pretty print” SQL strings</p>
<p>As shown throughout this documentation and if you’ve run the library yourself, it prints the SQL
statements with indentation for an easy debugging experience when you need to look at the rendered SQL.</p>
</li>
<li><p>Parameter value rendering</p>
<p>If you follow best practices you are undoubtedly utilizing <a class="reference internal" href="parameterized-queries.html"><span class="doc">Parameterized Queries</span></a>. As such, when
you render the SQL, what you will find is that the variables themselves are printed, which is necessary
and by design. However, if you need to troubleshoot the SQL statement with the actual values then it is
extremely cumbersome to do manually. This is resolved with a <code class="docutils literal notranslate"><span class="pre">.Build(object</span> <span class="pre">parameters)</span></code> overload
documented below.</p>
</li>
</ol>
<p><strong>Render SQL with Parameter Values</strong></p>
<p>Consider the following query that specifies a number of parameter variables.</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">sql</span> <span class="p">=</span> <span class="n">TSQL</span>

    <span class="p">.</span><span class="n">SELECT</span><span class="p">()</span>
      <span class="p">.</span><span class="n">STAR</span><span class="p">()</span>
    <span class="p">.</span><span class="n">FROM</span><span class="p">(</span><span class="s">&quot;Employees&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="n">WHERE</span><span class="p">(</span><span class="s">&quot;ReportsTo&quot;</span><span class="p">).</span><span class="n">IsEqualTo</span><span class="p">(</span><span class="s">&quot;@SupervisorId&quot;</span><span class="p">)</span>
      <span class="p">.</span><span class="n">AND</span><span class="p">().</span><span class="n">COLUMN</span><span class="p">(</span><span class="s">&quot;BirthDate&quot;</span><span class="p">).</span><span class="n">BETWEEN</span><span class="p">(</span><span class="s">&quot;@StartDate&quot;</span><span class="p">).</span><span class="n">AND</span><span class="p">(</span><span class="s">&quot;@EndDate&quot;</span><span class="p">)</span>
      <span class="p">.</span><span class="n">AND</span><span class="p">().</span><span class="n">COLUMN</span><span class="p">(</span><span class="s">&quot;Region&quot;</span><span class="p">).</span><span class="n">IsEqualTo</span><span class="p">(</span><span class="s">&quot;@Region&quot;</span><span class="p">)</span>
      <span class="p">.</span><span class="n">AND</span><span class="p">().</span><span class="n">COLUMN</span><span class="p">(</span><span class="s">&quot;PostalCode&quot;</span><span class="p">).</span><span class="n">IN</span><span class="p">(</span><span class="s">&quot;@PostalCodes&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="n">Build</span><span class="p">()</span>

<span class="p">;</span>

<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">sql</span><span class="p">);</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
 <span class="o">*</span>
<span class="k">FROM</span> <span class="p">[</span><span class="n">Employees</span><span class="p">]</span>
<span class="k">WHERE</span> <span class="mi">1</span><span class="o">=</span><span class="mi">1</span>
 <span class="k">AND</span> <span class="p">[</span><span class="n">ReportsTo</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="n">SupervisorId</span>
 <span class="k">AND</span> <span class="p">[</span><span class="n">BirthDate</span><span class="p">]</span> <span class="k">BETWEEN</span> <span class="o">@</span><span class="n">StartDate</span> <span class="k">AND</span> <span class="o">@</span><span class="n">EndDate</span>
 <span class="k">AND</span> <span class="p">[</span><span class="n">Region</span><span class="p">]</span> <span class="o">=</span> <span class="o">@</span><span class="n">Region</span>
 <span class="k">AND</span> <span class="p">[</span><span class="n">PostalCode</span><span class="p">]</span> <span class="k">IN</span> <span class="o">@</span><span class="n">PostalCodes</span>
</pre></div>
</div>
<p><a class="reference internal" href="where-1-equals-1.html"><span class="doc">WHERE 1=1 ?</span></a></p>
<p>First notice that the <code class="docutils literal notranslate"><span class="pre">IN</span></code> statement renders with a Dapper compatible parameter specification by
omitting the parentheses in the syntax of an <code class="docutils literal notranslate"><span class="pre">IN</span></code> statement.</p>
<p>Now, if you wanted to debug that statement with the values in the parameter variables at runtime,
you could do the following.</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">paramObj</span> <span class="p">=</span> <span class="k">new</span>
<span class="p">{</span>
    <span class="n">SupervisorId</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
    <span class="n">StartDate</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="p">(</span><span class="m">1930</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span>
    <span class="n">EndDate</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span><span class="m">12</span><span class="p">,</span><span class="m">31</span><span class="p">),</span>
    <span class="n">Region</span> <span class="p">=</span> <span class="s">&quot;WA&quot;</span><span class="p">,</span>
    <span class="n">PostalCodes</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="p">{</span> <span class="s">&quot;98122&quot;</span><span class="p">,</span> <span class="s">&quot;98105&quot;</span> <span class="p">},</span>
    <span class="n">SeattleOnly</span> <span class="p">=</span> <span class="k">true</span>
<span class="p">};</span>

<span class="kt">var</span> <span class="n">sql</span> <span class="p">=</span> <span class="n">TSQL</span>

    <span class="p">.</span><span class="n">SELECT</span><span class="p">()</span>
        <span class="p">.</span><span class="n">STAR</span><span class="p">()</span>
    <span class="p">.</span><span class="n">FROM</span><span class="p">(</span><span class="s">&quot;Employees&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="n">WHERE</span><span class="p">(</span><span class="s">&quot;ReportsTo&quot;</span><span class="p">).</span><span class="n">IsEqualTo</span><span class="p">(</span><span class="s">&quot;@SupervisorId&quot;</span><span class="p">)</span>
      <span class="p">.</span><span class="n">AND</span><span class="p">().</span><span class="n">COLUMN</span><span class="p">(</span><span class="s">&quot;BirthDate&quot;</span><span class="p">).</span><span class="n">BETWEEN</span><span class="p">(</span><span class="s">&quot;@StartDate&quot;</span><span class="p">).</span><span class="n">AND</span><span class="p">(</span><span class="s">&quot;@EndDate&quot;</span><span class="p">)</span>
      <span class="p">.</span><span class="n">AND</span><span class="p">().</span><span class="n">COLUMN</span><span class="p">(</span><span class="s">&quot;Region&quot;</span><span class="p">).</span><span class="n">IsEqualTo</span><span class="p">(</span><span class="s">&quot;@Region&quot;</span><span class="p">)</span>
      <span class="p">.</span><span class="n">AND</span><span class="p">().</span><span class="n">COLUMN</span><span class="p">(</span><span class="s">&quot;PostalCode&quot;</span><span class="p">).</span><span class="n">IN</span><span class="p">(</span><span class="s">&quot;@PostalCodes&quot;</span><span class="p">)</span>
      <span class="p">.</span><span class="n">AND</span><span class="p">()</span>
        <span class="p">.</span><span class="n">CASE</span><span class="p">(</span><span class="s">&quot;[City]&quot;</span><span class="p">)</span>
          <span class="p">.</span><span class="n">WHEN</span><span class="p">(</span><span class="s">&quot;Seattle&quot;</span><span class="p">).</span><span class="n">THEN</span><span class="p">(</span><span class="k">true</span><span class="p">)</span>
          <span class="p">.</span><span class="n">ELSE</span><span class="p">(</span><span class="k">false</span><span class="p">)</span>
      <span class="p">.</span><span class="n">END</span><span class="p">().</span><span class="n">IsEqualTo</span><span class="p">(</span><span class="s">&quot;@SeattleOnly&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="n">Build</span><span class="p">(</span><span class="n">paramObj</span><span class="p">)</span>

<span class="p">;</span>

<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">sql</span><span class="p">);</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span>
 <span class="o">*</span>
<span class="k">FROM</span> <span class="p">[</span><span class="n">Employees</span><span class="p">]</span>
<span class="k">WHERE</span> <span class="mi">1</span><span class="o">=</span><span class="mi">1</span>
 <span class="k">AND</span> <span class="p">[</span><span class="n">ReportsTo</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
 <span class="k">AND</span> <span class="p">[</span><span class="n">BirthDate</span><span class="p">]</span> <span class="k">BETWEEN</span> <span class="s1">&#39;1930-01-01 00:00:00&#39;</span> <span class="k">AND</span> <span class="s1">&#39;1970-12-31 00:00:00&#39;</span>
 <span class="k">AND</span> <span class="p">[</span><span class="n">Region</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;WA&#39;</span>
 <span class="k">AND</span> <span class="p">[</span><span class="n">PostalCode</span><span class="p">]</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">&#39;98122&#39;</span><span class="p">,</span><span class="s1">&#39;98105&#39;</span><span class="p">)</span>
 <span class="k">AND</span> <span class="k">CASE</span> <span class="p">[</span><span class="n">City</span><span class="p">]</span>
   <span class="k">WHEN</span> <span class="s1">&#39;Seattle&#39;</span> <span class="k">THEN</span> <span class="mi">1</span>
   <span class="k">ELSE</span> <span class="mi">0</span>
  <span class="k">END</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p><a class="reference internal" href="where-1-equals-1.html"><span class="doc">WHERE 1=1 ?</span></a></p>
<p>As you can see, the values are properly interpolated into the SQL statement. Data types that
should be quoted are quoted, data types that should not be quoted are not, and the collection
of values fed to the <code class="docutils literal notranslate"><span class="pre">IN</span></code> statement are properly formated with parentheses as well.</p>
<p>This accommodates runtime inspection of a query with values rendered by calling the <code class="docutils literal notranslate"><span class="pre">.BUILD(object</span> <span class="pre">parameters)</span></code>
overload.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Keep in mind that you should use this feature for debugging purposes only since submitting SQL
statements to the database with values directly interpolated into the SQL string defeats the
purpose of parameterized queries.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="security.html" class="btn btn-neutral float-right" title="Security" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="parameterized-queries.html" class="btn btn-neutral float-left" title="Parameterized Queries" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Ricardo Pena.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>